define("./active_x",["./component"],function(d){var d=d("./component"),g=function(a,b){for(var c in a)typeof a[c]=="function"&&c!="handleException"&&(a[c]=_.wrap(a[c],function(c){try{return c.apply(a,Array.prototype.slice.call(arguments,1))}catch(f){return b.call(a,f)}}))},e=d.extend({el:null,ocxEl:null,constructor:function(a,b,c){var d=a.el.attr("id");if(d)this.no=function(){return"ocx_"+d};b==null?b=["hikui-active"]:b.push("hikui-active");g(this,function(b){if(this.handleException)return this.handleException(b);
b=this.msgEl||this.el;this.ocxEl!=null&&this.ocxEl.hide();b.find('div[msgType="msg"]').remove();b.find("*").hide();var a=['<div class="msg-b msg-b-stop"><i></i><div class="msg-cnt">'];a.push("<span>"+language.text("ocx.error")+"</span>");if(this.getOcxUrl!=null){var c=null;if(typeof this.getOcxUrl=="function")c=this.getOcxUrl();else if(typeof this.getOcxUrl=="string")c=this.getOcxUrl;this.id.indexOf("swf_schedule")>-1?(a.push("<p>"+language.text("flash.error")),a.push("</p>")):c!=null&&(a.push("<p>"+
language.text("ocx.load")),a.push("</p>"))}a.push("</div></div>");b.append(a.join(""));return!1});this.base(a,b,c)},render:function(a){this.ocxEl=this.el.find("object");if(!this.ocxEl.length){var b=['<object classid="',a,'" width="100%" height="100%" id="',this.no(),'" name="',this.no(),'"'];this.codebase&&b.push(['CODEBASE="',pt.ctx,"/web/softs/HIKOCX.CAB#version=",this.codebase,'"'].join(""));b.push(" >");this.params&&$.each(this.params,function(a,d){b.push('<param name="');b.push(a);b.push('" value="');
b.push(d);b.push('">')});b.push("</object>");this.el.html(b.join(""));this.ocxEl=this.el.find("#"+this.no())}},throwError:function(a){throw Error(a);},destroy:function(){this.ocxEl!=null&&(this.ocxEl.hide(),this.ocxEl.remove());this.base()}});e.BASE_URL=d.BASE_URL;return e});
